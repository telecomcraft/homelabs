
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://labs.telecomcraft.com/labs/networks/general/exploring-subnets-broadcast-domains-and-bridges-in-proxmox/">
      
      
        <link rel="prev" href="../connecting-and-configuring-network-hosts-in-proxmox/">
      
      
        <link rel="next" href="../exploring-subnets-and-vlans-in-proxmox/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21+insiders-4.39.0">
    
    
      
        <title>Exploring Subnets, Broadcast Domains, and Bridges in Proxmox - Telecom Craft Home Labs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.02b45acc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ecc776e4.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exploring-subnets-broadcast-domains-and-bridges-in-proxmox" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Telecom Craft Home Labs" class="md-header__button md-logo" aria-label="Telecom Craft Home Labs" data-md-component="logo">
      
  <img src="../../../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Telecom Craft Home Labs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exploring Subnets, Broadcast Domains, and Bridges in Proxmox
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to Dark Mode"  type="radio" name="__palette" id="__palette_0">
            
              <label class="md-header__button md-icon" title="Switch to Dark Mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to Light Mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to Light Mode" for="__palette_0" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
              </label>
            
          
        </form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/telecomcraft/homelabs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    telecomcraft/homelabs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../blog/" class="md-tabs__link">
          
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../fiber/overview/" class="md-tabs__link">
          
  
  Fiber Labs

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../overview/" class="md-tabs__link md-tabs__link--active">
          
  
  Network Labs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../servers/overview/" class="md-tabs__link">
          
  
  Server Labs

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Telecom Craft Home Labs" class="md-nav__button md-logo" aria-label="Telecom Craft Home Labs" data-md-component="logo">
      
  <img src="../../../../assets/logo.svg" alt="logo">

    </a>
    Telecom Craft Home Labs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/telecomcraft/homelabs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    telecomcraft/homelabs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Index
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../blog/archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../blog/category/announcements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Announcements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Fiber Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Fiber Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../fiber/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Fiber Labs Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Network Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Network Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Network Labs Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    General Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    General Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../initial-proxmox-network-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Initial Proxmox Network Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../creating-a-network-host-template-in-proxmox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Creating a Network Host Template in Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../cloning-a-network-host-template-in-proxmox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cloning a Network Host Template in Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../connecting-and-configuring-network-hosts-in-proxmox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Connecting and Configuring Network Hosts in Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    
  
    Exploring Subnets, Broadcast Domains, and Bridges in Proxmox
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    
  
    Exploring Subnets, Broadcast Domains, and Bridges in Proxmox
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-examining-the-state-of-our-network-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Examining the State of Our Network Hosts
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-digging-into-ipv4-subnets-and-broadcast-domains" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Digging into IPv4 Subnets and Broadcast Domains
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-dipping-our-toes-into-bridging-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Dipping Our Toes into Bridging Details
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../exploring-subnets-and-vlans-in-proxmox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Exploring Subnets and VLANs in Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    VyOS Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    VyOS Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vyos/installing-vyos-on-proxmox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Installing VyOS on Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vyos/initial-vyos-configuration-best-practices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Initial VyOS Configuration Best Practices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    MikroTik Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    MikroTik Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mikrotik/installing-routeros-on-proxmox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Installing MikroTik RouterOS on Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Juniper Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Juniper Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../juniper/installing-vsrx-on-proxmox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Installing Juniper vSRX on Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6" >
        
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    APNIC Routing Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    APNIC Routing Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../apnic/routing-labs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../apnic/mikrotik/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    MikroTik
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Server Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Server Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../servers/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Server Labs Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-examining-the-state-of-our-network-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Examining the State of Our Network Hosts
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-digging-into-ipv4-subnets-and-broadcast-domains" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Digging into IPv4 Subnets and Broadcast Domains
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-dipping-our-toes-into-bridging-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Dipping Our Toes into Bridging Details
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
    <li class="md-path__item">
      <a href="../../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
    
    
      <li class="md-path__item">
        <a href="../../overview/" class="md-path__link">
          
  <span class="md-ellipsis">
    Network Labs
  </span>

        </a>
      </li>
    
  

      
        
  
    
    
      <li class="md-path__item">
        <a href="../initial-proxmox-network-configuration/" class="md-path__link">
          
  <span class="md-ellipsis">
    General Labs
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  
  

  <nav class="md-tags" >
    
      
      
        <a href="../../../../tags/#proxmox" class="md-tag">Proxmox</a>
      
    
      
      
        <a href="../../../../tags/#linux" class="md-tag">Linux</a>
      
    
  </nav>



  
  


<h1 id="exploring-subnets-broadcast-domains-and-bridges-in-proxmox">Exploring Subnets, Broadcast Domains, and Bridges in Proxmox</h1>
<p>Based on our progress in the last lab, <a href="../connecting-and-configuring-network-hosts-in-proxmox/">Connecting and Configuring Network Hosts in Proxmox</a>,
we know that our four hosts are somehow able to communicate within their subnet.
But how exactly are the hosts connecting?</p>
<p>Recall that each host is configured with a network device connected to the <code>vmbr1</code>
bridge and assigned an IPv4 address in the <code>10.0.1.0/24</code> subnet. These two factors are the key to understanding what is happening behind the scenes.</p>
<p>In this lab, we're going to begin exploring the concepts of subnets, broadcasting
domains, and bridges to allow our hosts to communicate (or not, in some cases).
Along the way, we'll see how these fundamental concepts lay the foundation for us
to build increasingly complex labs.</p>
<h2 id="step-1-examining-the-state-of-our-network-hosts">Step 1: Examining the State of Our Network Hosts</h2>
<p>The first thing we'll look at is the "state" of our network hosts. When <code>host1</code> sent
<code>ping</code> requests and an <code>nmap</code> scan to the other hosts, and received responses, it
created records of how to reach them. But how did it find them?</p>
<p>Remember the Address Resolution Protocol (ARP)? In IPv4, ARP is the first point of
contact between hosts on the same subnet. Because <code>host1</code> has already made contact
with each of the other hosts, it should have ARP records accessible that map each
host's IPv4 address with its MAC address, which is what is actually used to
communicate here on Layer 2.</p>
<p>When hosts are restarted, however, the ARP cache is flushed, so let's start out with
a clean ARP cache here, too, and populate it again so you can visibly see what's
happening. First flush <code>host1</code>'s ARP cache:</p>
<pre><code>ip neighbor flush dev eth0
</code></pre>
<p>Then perform the <code>nmap</code> network scan again:</p>
<pre><code>nmap -sn 10.0.1.0/24
</code></pre>
<p>which should produce something similar to the following output:</p>
<pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2023-06-21 19:07 UTC
Nmap scan report for 10.0.1.1
Host is up (0.00048s latency).
Nmap scan report for 10.0.1.2
Host is up (0.00044s latency).
Nmap scan report for 10.0.1.3
Host is up (0.00022s latency).
Nmap scan report for 10.0.1.4
Host is up (0.00013s latency).
Nmap done: 256 IP addresses (4 hosts up) scanned in 16.61 seconds
</code></pre>
<p>Now that we have a fresh network scan, let's look at <code>host1</code>'s ARP cache
using the <code>ip</code> tool, part of the <code>iproute2</code> suite of tools we'll be using
regularly in our labs:</p>
<pre><code>ip neighbor
</code></pre>
<p>which should output the following:</p>
<pre><code>10.0.1.3 dev eth0 lladdr 00:50:56:16:30:c7 REACHABLE
10.0.1.4 dev eth0 lladdr 00:50:56:ad:24:4a REACHABLE
10.0.1.2 dev eth0 lladdr 00:50:56:ad:0e:33 REACHABLE
</code></pre>
<p>Entries in a device's ARP cache are cached for a certain amount of time and
then cleared out, with the "soft" limit being once 512 entries are reached
and the "hard" limit being when there are 1,024 entries, at which point the
cache is cleared.</p>
<p>Check the ARP cache again:</p>
<pre><code>ip neighbor
</code></pre>
<p>and you will see the status of the existing entries have changed, and now indicate
they may be flushed if new MAC addresses continue actively populating the ARP cache:</p>
<pre><code>10.0.1.3 dev eth0 lladdr 00:50:56:16:30:c7 STALE
10.0.1.4 dev eth0 lladdr 00:50:56:ad:24:4a STALE
10.0.1.2 dev eth0 lladdr 00:50:56:ad:0e:33 STALE
</code></pre>
<p>We won't go much deeper into the innerworkings of the ARP cache at this point,
but we will study how the protocol works for neighbor discovery, so you can
see what goes on when hosts attempt to reach each other and how it relates to
the ARP cache.</p>
<p>To do this, let's operate from <code>host2</code>, and observe its interactions with <code>host1</code> at
the protocol level during a <code>ping</code> test. To begin, clear out <code>host2</code>'s ARP cache so
we're starting fresh again:</p>
<pre><code>sudo ip neighbor flush dev eth0
</code></pre>
<p>Return to <code>host1</code>, and begin a packet capture session using <code>tcpdump</code>, another crucial
tool we'll be using constantly in our labs:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>Switch back to <code>host2</code>, where we're going to send <code>host1</code> a single <code>ping</code> request:</p>
<pre><code>sudo ping -c 1 10.0.1.1
</code></pre>
<p>which should produce the following output:</p>
<pre><code>PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=64 time=0.148 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.148/0.148/0.148/0.000 ms
</code></pre>
<p>Here you can see that one request packet was sent from <code>host1</code> to <code>host2</code>, and a reply
packet from <code>host2</code> to <code>host1</code> was also successfully transferred, resulting in no packet
loss. The two hosts successfully communicated, which means each should now have a record
of the other in its ARP cache. Let's check <code>host2</code>'s ARP cache:</p>
<pre><code>ip neighbor
</code></pre>
<p>which shows a fresh entry for <code>host2</code>:</p>
<pre><code>10.0.1.1 dev eth0 lladdr 00:50:56:94:55:70 REACHABLE
</code></pre>
<p>This means that not only was <code>host2</code>'s <code>ping</code> request successful, but that <code>host1</code> was
properly captured in the ARP cache. The same is also true on the other side for <code>host1</code>.
How did all of this happen exchanging just two packets? It didn'tâ€”there were six
packets involved.</p>
<p>Let's return to <code>host1</code>, and cancel out (<code>CTRL</code>+<code>C</code>
on Windows) of the packet capture. Your output should look very similar to this:</p>
<pre><code>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
19:21:42.310066 ARP, Request who-has 10.0.1.1 tell 10.0.1.2, length 28
19:21:42.310088 ARP, Reply 10.0.1.1 is-at 00:50:56:94:55:70 (oui Unknown), length 28
19:21:42.310132 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 21255, seq 1, length 64
19:21:42.310140 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 21255, seq 1, length 64
19:21:47.343328 ARP, Request who-has 10.0.1.2 tell 10.0.1.1, length 28
19:21:47.343360 ARP, Reply 10.0.1.2 is-at 00:50:56:ad:0e:33 (oui Unknown), length 28
^C
6 packets captured
6 packets received by filter
0 packets dropped by kernel
</code></pre>
<p>We'll dig deep into analyzing packets in future labs, but knowing the basics is an
invaluable skill from the beginning of your learning to enhance your ability to
observe how protocols work and troubleshoot network issues that inevitably arise. So
let's start with the packet capture from <code>host2</code>.</p>
<p>On line 2, you see that <code>tcpdump</code> was listening on <code>host1</code>'s <code>eth0</code> interface, which
is connected to <code>host2</code> via bridge <code>vmbr1</code> (again, think "switch"). That's obvious
for this lab, as there's only one interface, but always check on devices with
multiple ports.</p>
<p>The next two lines, 3 and 4, are ARP packets. The first, at 19:21:42.310066, is a
broadcast request from the bridge <code>vmbr1</code> to all hosts on the subnet asking who is
<code>10.0.1.1</code>, as <code>10.0.1.2</code> needs to know. The next packet, at 19:21:42.310088, is 
the broadcast reply from <code>10.0.1.1</code> letting the bridge and <code>10.0.1.2</code> that it has
that IP address, and its MAC address is <code>00:50:56:94:55:70</code> (we'll discuss OUIs
later).</p>
<p>The bridge, like any switch, then sends the 3rd packet, at 19:21:42.310132, which
is the ICMP echo request (the formal term for the protocol used by <code>ping</code>), to
<code>host1</code>, now knowing who it is. <code>host1</code> responds with the proper ICMP echo reply
in the packet at 19:21:42.310140, addressed to <code>10.0.1.2</code>, but not sure which host
that is.</p>
<p>As a result, <code>host1</code> also utilizes ARP in packet 5, at 19:21:47.343328, broadcasting
a request asking who has <code>10.0.1.2</code>, as <code>10.0.1.1</code> needs to know. The sixth packet,
at 19:21:47.343360, is the broadcast reply from <code>10.0.1.2</code> letting the bridge and
<code>10.0.1.2</code> that it has that IP address, and its MAC address is <code>00:50:56:ad:0e:33</code>.</p>
<p>When the packet capture was stopped, it completed its job by reporting the number
of packets captured, filtered, and dropped. We didn't have a filter defined, such
as filtering out ARP packets, and no packets were dropped because of other
transmission issues, so it was a successful job.</p>
<p>One last point about ARP before we move on. Once <code>host1</code> and <code>host2</code> know each other,
is ARP no longer necessary, since they can simply address each other directly during
communication? As with anything in our labs, let's test it out.</p>
<p>Just like before, put <code>host1</code> into a packet capture mode:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>and have <code>host2</code> ping <code>host1</code>. This time, however, have <code>host2</code> flood ping <code>host1</code> 25
times:</p>
<pre><code>sudo ping -f -c 25 10.0.1.1
</code></pre>
<p>This should result in something like the following:</p>
<pre><code>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
02:14:34.087556 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 1, length 64
02:14:34.087576 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 1, length 64
02:14:34.087644 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 2, length 64
02:14:34.087647 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 2, length 64
02:14:34.087702 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 3, length 64
02:14:34.087705 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 3, length 64
02:14:34.087740 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 4, length 64
02:14:34.087743 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 4, length 64
02:14:34.087769 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 5, length 64
02:14:34.087772 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 5, length 64
02:14:34.087797 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 6, length 64
02:14:34.087800 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 6, length 64
02:14:34.087845 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 7, length 64
02:14:34.087848 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 7, length 64
02:14:34.087897 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 8, length 64
02:14:34.087900 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 8, length 64
02:14:34.087933 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 9, length 64
02:14:34.087936 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 9, length 64
02:14:34.087962 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 10, length 64
02:14:34.087964 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 10, length 64
02:14:34.087997 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 11, length 64
02:14:34.088000 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 11, length 64
02:14:34.088033 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 12, length 64
02:14:34.088036 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 12, length 64
02:14:34.088078 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 13, length 64
02:14:34.088081 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 13, length 64
02:14:34.088105 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 14, length 64
02:14:34.088108 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 14, length 64
02:14:34.088141 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 15, length 64
02:14:34.088144 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 15, length 64
02:14:34.088178 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 16, length 64
02:14:34.088180 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 16, length 64
02:14:34.088221 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 17, length 64
02:14:34.088224 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 17, length 64
02:14:34.088255 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 18, length 64
02:14:34.088257 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 18, length 64
02:14:34.088295 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 19, length 64
02:14:34.088298 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 19, length 64
02:14:34.088329 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 20, length 64
02:14:34.088331 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 20, length 64
02:14:34.088373 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 21, length 64
02:14:34.088375 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 21, length 64
02:14:34.088414 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 22, length 64
02:14:34.088417 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 22, length 64
02:14:34.088448 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 23, length 64
02:14:34.088450 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 23, length 64
02:14:34.088475 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 24, length 64
02:14:34.088478 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 24, length 64
02:14:34.088502 IP 10.0.1.2 &gt; 10.0.1.1: ICMP echo request, id 9783, seq 25, length 64
02:14:34.088504 IP 10.0.1.1 &gt; 10.0.1.2: ICMP echo reply, id 9783, seq 25, length 64
02:14:39.183337 ARP, Request who-has 10.0.1.2 tell 10.0.1.1, length 28
02:14:39.183380 ARP, Reply 10.0.1.2 is-at 00:50:56:ad:0e:33 (oui Unknown), length 28
^C
52 packets captured
52 packets received by filter
0 packets dropped by kernel
</code></pre>
<p>So the basic answer is that, for the most part, once hosts have cached their addresses
in the ARP cache, they can communicate via unicast transmission. Every so often,
however, ARP checks are sent to verify host addressing, thus the two extra packets in
addition to the 25 pairs of ICMP request/reply pairs.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Wondering how often ARP is part of the transmissions between known hosts? Modify
the <code>ping</code> command above to use higher count flood pings and see what happens. If
it's too many, does the kernel drop packets?</p>
</div>
<p>As we saw with the ARP process, communication between hosts begins with broadcasts
across their subnet to determine which hosts have which MAC and IP addresses. Let's
move on and learn more about the role of subnets and broadcast domains.</p>
<h2 id="step-2-digging-into-ipv4-subnets-and-broadcast-domains">Step 2: Digging into IPv4 Subnets and Broadcast Domains</h2>
<p>Currently our network consists of four hosts all assigned IPv4 addresses in the
same subnet of <code>10.0.1.0/24</code>, all contained in the same Layer 2 bridge <code>vmbr1</code>.
Because they are in the same subnet, and on the same bridge, they should always
be able to communicate. We've verifed this using both <code>ping</code> and <code>nmap</code> tests.</p>
<p>Performing a packet capture, we've also seen what happens during communication
at the protocol layer, with hosts broadcasting ARP requests/replies to all hosts
when identifying each other. How does broadcasting work within a subnet?</p>
<p>As we know, a subnet is a defined IP space assigned to hosts. So far, we have
assigned the IPs</p>
<ul>
<li><code>10.0.1.1</code> to <code>host1</code></li>
<li><code>10.0.1.2</code> to <code>host2</code></li>
<li><code>10.0.1.3</code> to <code>host3</code></li>
<li><code>10.0.1.4</code> to <code>host4</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You might have noticed that the last "octet" of each host matches the number
in each host name. IP addressing is generally arbitrary, but we'll do things
like this in some cases to help you follow along in these early labs.</p>
</div>
<p>How many hosts can we have in this address space? You probably have seen many ways
to calculate subnet sizes, but let's make it easy by using another handy tool on
our Linux hosts: <code>ipcalc</code>.</p>
<p>Ask <code>ipcalc</code> to calculate the details of our <code>10.0.1.0/24</code> subnet from <code>host1</code>:</p>
<pre><code>ipcalc 10.0.1.0/24
</code></pre>
<p>which reports back the following:</p>
<pre><code>Address:   10.0.1.0             00001010.00000000.00000001. 00000000
Netmask:   255.255.255.0 = 24   11111111.11111111.11111111. 00000000
Wildcard:  0.0.0.255            00000000.00000000.00000000. 11111111
=&gt;
Network:   10.0.1.0/24          00001010.00000000.00000001. 00000000
HostMin:   10.0.1.1             00001010.00000000.00000001. 00000001
HostMax:   10.0.1.254           00001010.00000000.00000001. 11111110
Broadcast: 10.0.1.255           00001010.00000000.00000001. 11111111
Hosts/Net: 254                   Class A, Private Internet
</code></pre>
<p><code>ipcalc</code> has provided us everything we need to know about our subnet in a very
nice format. On the left is the name of each calculation, followed by the value
in IPv4 integer octets, then the value again formatted as binary octets (for all
IP-related data). The last line is a bit different, which we'll also cover
below.</p>
<ul>
<li>The Address line shows the address that we submitted in the command</li>
<li>The Netmask line shows the netmask that we submitted in the command, both in
octet and CIDR format</li>
<li>The Wildcard line shows the usable portion of the address within the subnet
while everything in the first three octets remains fixed</li>
<li>The Network line shows the network ID for this subnet, which you'll recall
we used in our <code>nmap</code> network discovery scans</li>
<li>The HostMin line shows the first address in this subnet available for host
assignment; and we've assigned this value to <code>host1</code></li>
<li>The HostMax line shows the last address in this subnet available for host
assignment, and we haven't assigned this value to any host yet</li>
<li>The Broadcast line shows the broadcast address in this subnet</li>
<li>The Hosts/Net line shows the total number of hosts available in this subnet,
which is 256 in our case</li>
</ul>
<p>The Network address cannot be assigned to a host, thus it cannot respond to
<code>ping</code> requests, either. Let's verify this with a test from <code>host1</code>:</p>
<pre><code>sudo ping -c 4 10.0.1.0
</code></pre>
<p>which results in no replies, as expected:</p>
<pre><code>PING 10.0.1.0 (10.0.1.0) 56(84) bytes of data.
From 10.0.1.1 icmp_seq=1 Destination Host Unreachable
From 10.0.1.1 icmp_seq=2 Destination Host Unreachable
From 10.0.1.1 icmp_seq=3 Destination Host Unreachable
From 10.0.1.1 icmp_seq=4 Destination Host Unreachable

--- 10.0.1.0 ping statistics ---
4 packets transmitted, 0 received, +4 errors, 100% packet loss, time 3077ms
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Before we move on, bring up a detached console window for each host in Proxmox
by clicking the <code>Console</code> button near the top-right of each guest view, and
arrange them on your screen so they're all visible. Depending on your desktop,
there are "quarter tile" features built-in, such as in Windows or KDE, or
extentions available, such as <a href="https://rectangleapp.com/">Rectangle</a> for macOS
or <a href="https://extensions.gnome.org/extension/1723/wintile-windows-10-window-tiling-for-gnome/">WinTile</a>
for GNOME.</p>
</div>
<p>We already know we can ping <code>10.0.1.1</code> through <code>10.0.1.4</code>, and anything up to
<code>10.0.1.254</code> if we had hosts assigned to those IP addresses. But what about the
broadcast address? Don't hosts use that for ARP request/replies? Let's try to
ping it from <code>host1</code>:</p>
<pre><code>sudo ping 10.0.1.255
</code></pre>
<p>and we get an interesting response:</p>
<pre><code>ping: Do you want to ping broadcast? Then -b. If not, check your local firewall rules
</code></pre>
<p>The <code>ping</code> command is giving us a helpful tip: if we want to ping the broadcast
address, we need to add the <code>-c</code> flag to the command. Let's try again from
<code>host1</code>:</p>
<pre><code>sudo ping -b 10.0.1.255
</code></pre>
<p>and now we get the following output:</p>
<pre><code>WARNING: pinging broadcast address
PING 10.0.1.255 (10.0.1.255) 56(84) bytes of data.
</code></pre>
<p>At this point <code>ping</code> is sending ICMP requests, but nothing is visible in the
output like it would a normal ping test. How can we observe what's happening?
Let's check our other hosts.</p>
<p>On <code>host2</code>, <code>host3</code>, and <code>host4</code>, run the following command:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>Upon doing this, you should see something similar to the following:</p>
<pre><code>01:15:56.463377 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 59888, seq 29, length 64
01:15:57.487378 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 59888, seq 30, length 64
01:15:58.515390 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 59888, seq 31, length 64
01:15:59.535379 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 59888, seq 32, length 64
01:16:00.559384 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 59888, seq 33, length 64
</code></pre>
<p>In these packet captures, you're seeing broadcast requests from <code>host1</code> at <code>10.0.1.1</code> to
the broadcast address for this subnet at <code>10.0.1.255</code>. In this case, there are two key
things to notice:</p>
<ol>
<li>Each packet is an ICMP echo request, with no ICMP echo reply being returned</li>
<li>Within each host's console, the <code>seq</code> count matches, showing that every host is
receiving the broadcasts simultaneously</li>
</ol>
<p>Return to <code>host1</code> and cancel the broadcast pings with <code>Ctrl</code>+<code>C</code>, and look at the
results:</p>
<pre><code>WARNING: pinging broadcast address
PING 10.0.1.255 (10.0.1.255) 56(84) bytes of data.
^C
--- 10.0.1.255 ping statistics ---
33 packets transmitted, 0 received, 100% packet loss, time 32757ms
</code></pre>
<p>In this case, 33 packets (here in my case, for example) were broadcasted, but
<code>host1</code> believes none were received resulting in 100% packet loss. However, as we
saw using <code>tcpdump</code>, the packets were delivered, but no protocol, such as ARP, was
targeted for a reply.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are times where hosts may reply to broadcast pings using approaches such
as <code>nmap --script broadcast-ping</code>, but it is not a reliable method depending on
the host configuration.</p>
</div>
<p>Now that we've experimented with broadcasts a bit, let's consider the broadcast
domain itself. So far, we've observed that all hosts in the subnet can be reached
via unicast and broadcast communication. Does this mean the subnet and broadcast
domain are contiguous? Let's test this by making a change.</p>
<p>From Proxmox's UI, change <code>host2</code>'s IPv4 address to <code>10.0.2.2/24</code>. By doing this,
we create a second subnet within the same bridge <code>vmbr1</code>. Next, calculate
<code>host2</code>'s subnet details using the <code>ipcalc</code> tool:</p>
<pre><code>ipcalc 10.0.2.2/24
</code></pre>
<p>and we can see from the results that <code>host2</code> is now in a completely different
subnet:</p>
<pre><code>Address:   10.0.2.2             00001010.00000000.00000010. 00000010
Netmask:   255.255.255.0 = 24   11111111.11111111.11111111. 00000000
Wildcard:  0.0.0.255            00000000.00000000.00000000. 11111111
=&gt;
Network:   10.0.2.0/24          00001010.00000000.00000010. 00000000
HostMin:   10.0.2.1             00001010.00000000.00000010. 00000001
HostMax:   10.0.2.254           00001010.00000000.00000010. 11111110
Broadcast: 10.0.2.255           00001010.00000000.00000010. 11111111
Hosts/Net: 254                   Class A, Private Internet
</code></pre>
<ul>
<li>The Network is now <code>10.0.2.0/24</code>, not <code>10.0.1.0/24</code></li>
<li>The HostMin is now <code>10.0.2.1</code> and the HostMax is now <code>10.0.2.254</code></li>
<li>The Broadcast is now <code>10.0.2.255</code></li>
</ul>
<p>Going back to <code>host1</code>, try to ping <code>host2</code>:</p>
<pre><code>sudo ping 10.0.2.2
</code></pre>
<p>Doing this will issue an error:</p>
<pre><code>ping: connect: Network is unreachable
</code></pre>
<p>Try the same from <code>host2</code>, and try to ping <code>host1</code>:</p>
<pre><code>sudo ping 10.0.1.1
</code></pre>
<p>Again, the other subnet is unreachable:</p>
<pre><code>ping: connect: Network is unreachable
</code></pre>
<p>It appears both subnets are isolated from each other, and for subnets on the
same switch, this is generally what you want. But are they? Let's try a
broadcast from <code>host1</code> to its subnet's broadcast address. First start the
broadcasting from <code>host1:</code></p>
<pre><code>sudo ping -b 10.0.1.255
</code></pre>
<p>Next, start a packet capture on <code>host2</code>:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>Did you end up with something similar to the output displayed below? What are you
now seeing on <code>host2</code>? ICMP requests from <code>host1</code> on the other network? Apparently
broadcast domains are larger in scope than subnets.</p>
<pre><code>18:05:12.216806 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 2358, seq 1, length 64
18:05:13.231371 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 2358, seq 2, length 64
18:05:14.255380 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 2358, seq 3, length 64
18:05:15.279377 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 2358, seq 4, length 64
18:05:16.303372 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 2358, seq 5, length 64
18:05:17.327376 IP 10.0.1.1 &gt; 10.0.1.255: ICMP echo request, id 2358, seq 6, length 64
</code></pre>
<p>It appears that hosts on different subnets cannot directly communicate with each
other at Layer 3, but communication is still possible at Layer 2. This is because
there is a difference between a Layer 3 broadcast address and a Layer 2 broadcast
domain.</p>
<p>These are the next questions we need to explore with our labs:</p>
<ol>
<li>How would we prevent communication between subnets at Layer 2</li>
<li>How would we allow communication between subnets at Layer 3</li>
</ol>
<p>Before we wrap up this lab, let's consider the role of bridging in this situation.</p>
<h2 id="step-3-dipping-our-toes-into-bridging-details">Step 3: Dipping Our Toes into Bridging Details</h2>
<p>Recall the differences between hubs and switches. Hubs broadcast all frames out
to all connected hosts, and not those destined for the broadcast address. All
connected hosts are also in the same collision domain, causing packets to collide
when hosts attempt to communicate at the same time.</p>
<p>Switches, however, can enable unicast communication between hosts while limiting
broadcasts to all hosts. Each port on a switch is a separate collision domain, as
well, preventing packet transmissions among hosts from interfering with each
other.</p>
<p>What about our Linux bridge? In an earlier lab I stated bridges are basically
switches, especially in eliminating the impact of collision domains, but they
share other characteristics, too. Let's make some more changes to our network
to experiment with the impact of bridges on subnets and broadcast domains.</p>
<p>The first thing we need to do is create another Linux bridge on our Proxmox
hypervisor:</p>
<ol>
<li>At the top of the Proxmox resource tree, select the Proxmox node your lab is
running within and then select the <code>System</code> &gt; <code>Network</code> view of the content panel.</li>
<li>At the top-left of the network device table, click the <code>Create</code> dropdown button
and select <code>Linux Bridge</code>.</li>
<li>In the dialog box, ensure the Name is <code>vmbr2</code> and Autostart is checked, then
click the Create button.</li>
<li>At the top of the network device table, click the Apply Configuration button
and the new bridge will be enabled.</li>
</ol>
<p>Next, edit <code>host2</code>s network configuration in Proxmox by setting the <code>eth0</code>
network device's bridge to <code>vmbr2</code>. Be sure to keep the IPv4 address the
same, however.</p>
<p>Now, again start pinging from <code>host1</code> to its broadcast address:</p>
<pre><code>sudo ping -b 10.0.1.255
</code></pre>
<p>Then start another packet capture on <code>host2</code>:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>What happened this time? Let's look at the results of <code>host1</code>'s and <code>host2</code>'s
output together:</p>
<pre><code>WARNING: pinging broadcast address
PING 10.0.1.255 (10.0.1.255) 56(84) bytes of data.
^C
--- 10.0.1.255 ping statistics ---
145 packets transmitted, 0 received, 100% packet loss, time 147437ms
</code></pre>
<pre><code>listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
^C
0 packets captured
0 packets received by filter
0 packets dropped by kernel
</code></pre>
<p>In this case, <code>host1</code> transmitted 145 packets, but <code>host2</code> captured none of
them. Now Layer 2 communication is blocked by creating a second bridge, thus
creating two broadcast domains. Bridging seems key to answering the question
about preventing communication between subnets at Layer 2.</p>
<p>Before we wrap up, let's perform a larger test of both unicast and broadcast
communication. Like <code>host2</code>, change <code>host4</code>'s Bridge to <code>vmbr2</code>, but keep
its IPv4 address <code>10.0.1.4/24</code>. Then arrange the console windows for all four
hosts in a quarter tile layout so they're all visible.</p>
<p>Start a packet capture again on <code>host2</code>:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>and start a ping test on <code>host4</code> to that subnet's broadcast address:</p>
<pre><code>sudo ping -b -c 4 10.0.1.255
</code></pre>
<p>Next, start a packet capture on <code>host1</code>:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>and start a ping test on <code>host3</code>:</p>
<pre><code>sudo ping -b -c 4 10.0.1.255
</code></pre>
<p>Let's review the results for each host, grouped by bridge.</p>
<p><code>host3</code> sent four ICMP echo requests, which were detected (but not replied to)
by <code>host1</code> within bridge <code>vmbr1</code>:</p>
<pre><code>eron@host3:~$ sudo ping -b -c 4 10.0.1.255
WARNING: pinging broadcast address
PING 10.0.1.255 (10.0.1.255) 56(84) bytes of data.

--- 10.0.1.255 ping statistics ---
4 packets transmitted, 0 received, 100% packet loss, time 3072ms
</code></pre>
<pre><code>eron@host1:~$ sudo tcpdump
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
11:23:16.591449 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 54008, seq 1, length 64
11:23:17.615374 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 54008, seq 2, length 64
11:23:18.639371 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 54008, seq 3, length 64
11:23:19.663375 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 54008, seq 4, length 64
^C
4 packets captured
4 packets received by filter
0 packets dropped by kernel
</code></pre>
<p>Just as above, <code>host4</code> sent four ICMP echo requests, which were detected (but not
replied to) by <code>host2</code> within bridge <code>vmbr2</code>:</p>
<pre><code>eron@host4:~$ sudo ping -b -c 4 10.0.1.255
WARNING: pinging broadcast address
PING 10.0.1.255 (10.0.1.255) 56(84) bytes of data.

--- 10.0.1.255 ping statistics ---
4 packets transmitted, 0 received, 100% packet loss, time 3064ms
</code></pre>
<pre><code>eron@host2:~$ sudo tcpdump
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
11:22:47.191030 IP 10.0.1.4 &gt; 10.0.1.255: ICMP echo request, id 27961, seq 1, length 64
11:22:48.207371 IP 10.0.1.4 &gt; 10.0.1.255: ICMP echo request, id 27961, seq 2, length 64
11:22:49.231376 IP 10.0.1.4 &gt; 10.0.1.255: ICMP echo request, id 27961, seq 3, length 64
11:22:50.255377 IP 10.0.1.4 &gt; 10.0.1.255: ICMP echo request, id 27961, seq 4, length 64
^C
4 packets captured
4 packets received by filter
0 packets dropped by kernel
</code></pre>
<p>Within bridge <code>vmbr1</code>, the two hosts were in the same subnet, and the broadcasts
were captured as expected. Within bridge <code>vmbr2</code>, the two hosts were not in the
same subnet, but the broadcasts were still captured.</p>
<p>Remember that this was also expected, because regardless of the subnet, broadcasts
are being transmitted across the entire Layer 2 broadcast domain, which right now
is the entire bridge.</p>
<p>So we see that bridges can isolate broadcast domains, but only when there is one
subnet per bridge. But that essentially means having to restrict an entire switch
to only one subnet, which is unrealistic in nearly any network with multiple
subnets. In a physical network, this would require a switch for each subnet.</p>
<p>As our final experiment, let's move <code>host2</code> and <code>host4</code> back to <code>vmbr1</code>, and
change <code>host4</code>'s IPv4 address to <code>10.0.2.4/24</code>, so it's in the same subnet as
<code>host2</code>. With those configuration changes made, we now have two subnets, each with
two hosts, on one bridge. What happens when they start communicating?</p>
<p>Start a packet capture on <code>host1</code>:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>and start a ping test to <code>10.0.1.0/24</code> network's broadcast address from <code>host3</code>:</p>
<pre><code>sudo ping -b -c 4 10.0.1.255
</code></pre>
<p>Next start a packet capture on <code>host2</code>:</p>
<pre><code>sudo tcpdump
</code></pre>
<p>and start a ping test to <code>10.0.2.0/24</code> network's broadcast address from <code>host4</code>:</p>
<pre><code>sudo ping -b -c 4 10.0.2.255
</code></pre>
<p>Again we'll review the results for each host, grouped by bridge.</p>
<p><code>host3</code> sent four ICMP echo requests, which were detected (but not replied to)
by <code>host1</code> within bridge <code>vmbr1</code>:</p>
<pre><code>eron@host3:~$ sudo ping -b -c 4 10.0.1.255
WARNING: pinging broadcast address
PING 10.0.1.255 (10.0.1.255) 56(84) bytes of data.

--- 10.0.1.255 ping statistics ---
4 packets transmitted, 0 received, 100% packet loss, time 3065ms
</code></pre>
<pre><code>eron@host1:~$ sudo tcpdump
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
15:07:12.790897 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 57207, seq 1, length 64
15:07:13.807380 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 57207, seq 2, length 64
15:07:14.831382 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 57207, seq 3, length 64
15:07:15.855384 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 57207, seq 4, length 64
15:07:44.485779 IP 10.0.2.4 &gt; 10.0.2.255: ICMP echo request, id 7169, seq 1, length 64
15:07:45.487366 IP 10.0.2.4 &gt; 10.0.2.255: ICMP echo request, id 7169, seq 2, length 64
15:07:46.511402 IP 10.0.2.4 &gt; 10.0.2.255: ICMP echo request, id 7169, seq 3, length 64
15:07:47.535375 IP 10.0.2.4 &gt; 10.0.2.255: ICMP echo request, id 7169, seq 4, length 64
^C
8 packets captured
8 packets received by filter
0 packets dropped by kernel
</code></pre>
<p>But wait, there are four broadcast packets from <code>host4</code> here as well! All <code>host4</code>
did was send four ICMP echo requests on its own subnet, which were detected (but
not replied to) by <code>host2</code> within bridge <code>vmbr1</code>:</p>
<pre><code>eron@host4:~$ sudo ping -b -c 4 10.0.2.255
WARNING: pinging broadcast address
PING 10.0.2.255 (10.0.2.255) 56(84) bytes of data.

--- 10.0.2.255 ping statistics ---
4 packets transmitted, 0 received, 100% packet loss, time 3050ms
</code></pre>
<pre><code>eron@host2:~$ sudo tcpdump
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
15:07:12.790892 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 57207, seq 1, length 64
15:07:13.807374 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 57207, seq 2, length 64
15:07:14.831376 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 57207, seq 3, length 64
15:07:15.855379 IP 10.0.1.3 &gt; 10.0.1.255: ICMP echo request, id 57207, seq 4, length 64
15:07:44.485776 IP 10.0.2.4 &gt; 10.0.2.255: ICMP echo request, id 7169, seq 1, length 64
15:07:45.487364 IP 10.0.2.4 &gt; 10.0.2.255: ICMP echo request, id 7169, seq 2, length 64
15:07:46.511399 IP 10.0.2.4 &gt; 10.0.2.255: ICMP echo request, id 7169, seq 3, length 64
15:07:47.535372 IP 10.0.2.4 &gt; 10.0.2.255: ICMP echo request, id 7169, seq 4, length 64
^C
8 packets captured
8 packets received by filter
0 packets dropped by kernel
</code></pre>
<p>The packet capture from <code>host2</code> shows packets from <code>host4</code> along with those from
<code>host3</code> as well! So now we really see the problem: how can we restrict broadcast
domains within the same bridge or switch containing multiple subnets?</p>
<p>We'll figure that out in the next lab, <a href="../exploring-subnets-and-vlans-in-proxmox/">Exploring Subnets and VLANs in Proxmox</a>.
Great work today; I know this was a long lab, but hopefully these concepts are
starting to make sense.</p>

  
    
  
  
    
  


  <aside class="md-source-file">
    
      <span class="md-source-file__fact">
        <span class="md-icon" title="Last update">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
        </span>
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 27, 2023</span>
      </span>
    
    
      <span class="md-source-file__fact">
        <span class="md-icon" title="Created">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
        </span>
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 25, 2023</span>
      </span>
    
    
    
      <span class="md-source-file__fact">
        <span class="md-icon" title="Contributors">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>
        </span>
        <span>GitHub</span>
        <nav>
          
            <a href="https://github.com/eronlloyd" class="md-author" title="@eronlloyd">
              
              <img src="https://avatars.githubusercontent.com/u/197778?size=72" alt="eronlloyd">
            </a>
          
          
          
        </nav>
      </span>
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      All content licensed under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons</a> by Telecom Craft â€“ <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@telecomcraft" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/telecomcraft" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/telecomcraft" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.twitter.com/thetelecomcraft" target="_blank" rel="noopener" title="www.twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  
    
  




  

<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" checked>
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.top", "navigation.expand", "navigation.path", "search.highlight", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.6c7302c4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.7c5c0157.min.js"></script>
      
    
  </body>
</html>